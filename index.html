<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>⚽ BSV Fußballcamp Anmeldung</title>
<style>
  body {
    background: linear-gradient(180deg, #00234a 0%, #01396e 100%);
    color: white;
    font-family: Arial, sans-serif;
    text-align: center;
    margin: 0;
    padding-top: 20vh;
  }
  h1 {
    color: #76c3ff;
    font-size: 2em;
    margin-bottom: 0.5em;
  }
  .loader {
    margin: 30px auto;
    border: 6px solid rgba(255, 255, 255, 0.2);
    border-top: 6px solid #76c3ff;
    border-radius: 50%;
    width: 70px;
    height: 70px;
    animation: spin 1s linear infinite;
  }
  @keyframes spin {
    100% { transform: rotate(360deg); }
  }
  #status {
    margin-top: 1em;
    font-size: 1.1em;
    opacity: 0.9;
  }
  #manual {
    display: none;
    margin-top: 2em;
  }
  a {
    color: #76c3ff;
    font-weight: bold;
    text-decoration: underline;
  }
</style>
</head>
<body>
  <img src="https://upload.wikimedia.org/wikipedia/en/f/fe/Bremer_SV_logo.png"
       alt="BSV Logo"
       style="width:100px;margin-bottom:20px;">
  <h1>⚽ BSV Fußballcamp Anmeldung</h1>
  <div class="loader"></div>
  <p id="status">Das Anmeldetool startet – bitte einen Moment Geduld …</p>
  <p id="manual">Wenn die Seite nach einiger Zeit nicht lädt,
  <a href="https://bsv-fussballschule-anmeldungen.onrender.com">hier klicken</a>.</p>

  <script>
    const renderURL = "https://bsv-fussballschule-anmeldungen.onrender.com";
    const healthURL = renderURL + "/healthz";
    const statusEl = document.getElementById("status");
    const manualEl = document.getElementById("manual");

    async function waitForRender() {
      while (true) {
        try {
          const res = await fetch(healthURL, { method: "GET", cache: "no-store" });
          if (res.ok) {
            statusEl.textContent = "Tool ist bereit – du wirst weitergeleitet …";
            setTimeout(() => window.location.href = renderURL, 800);
            return;
          }
        } catch (err) {
          console.log("⏳ Render schläft oder startet noch …");
          statusEl.textContent = "Das Anmeldetool startet – bitte einen Moment Geduld …";
        }
        await new Promise(resolve => setTimeout(resolve, 5000));
      }
    }

    // Falls Render länger als 60 Sekunden schläft → Fallback-Link anzeigen
    setTimeout(() => {
      manualEl.style.display = "block";
    }, 60000);

    waitForRender();
  </script>
</body>
</html>
